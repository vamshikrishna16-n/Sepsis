{% extends "base.html" %}

{% block title %}Edit Reading - {{ patient.name }}{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">
    <div class="mb-8">
        <h1 class="text-3xl font-bold" style="color: #3D0066;">Edit Patient Reading</h1>
        <p class="text-gray-600 mt-2">Patient: {{ patient.name }} ({{ patient.age }} years, {{ patient.gender }})</p>
    </div>

    <div class="bg-white shadow sm:rounded-lg">
        <div class="px-4 py-5 sm:p-6">
            <form method="POST" class="space-y-8">
                <!-- Vital Signs Section -->
                <div>
                    <h3 class="text-lg font-semibold mb-4" style="color: #3D0066;">Vital Signs</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div>
                            <label for="hr" class="block text-sm font-medium text-gray-700">Heart Rate (bpm)</label>
                            <input type="number" name="hr" id="hr" step="0.0001" value="{{ reading.hr }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="o2sat" class="block text-sm font-medium text-gray-700">O2 Saturation (%)</label>
                            <input type="number" name="o2sat" id="o2sat" step="0.0001" value="{{ reading.o2sat }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="temp" class="block text-sm font-medium text-gray-700">Temperature (°C)</label>
                            <input type="number" name="temp" id="temp" step="0.0001" value="{{ reading.temp }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="sbp" class="block text-sm font-medium text-gray-700">Systolic BP (mmHg)</label>
                            <input type="number" name="sbp" id="sbp" step="0.0001" value="{{ reading.sbp }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="map" class="block text-sm font-medium text-gray-700">Mean Arterial Pressure (mmHg)</label>
                            <input type="number" name="map" id="map" step="0.0001" value="{{ reading.map }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="dbp" class="block text-sm font-medium text-gray-700">Diastolic BP (mmHg)</label>
                            <input type="number" name="dbp" id="dbp" step="0.0001" value="{{ reading.dbp }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="resp" class="block text-sm font-medium text-gray-700">Respiration Rate (breaths/min)</label>
                            <input type="number" name="resp" id="resp" step="0.0001" value="{{ reading.resp }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="etco2" class="block text-sm font-medium text-gray-700">EtCO2 (mmHg)</label>
                            <input type="number" name="etco2" id="etco2" step="0.0001" value="{{ reading.etco2 }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="hco3" class="block text-sm font-medium text-gray-700">HCO3 (mEq/L)</label>
                            <input type="number" name="hco3" id="hco3" step="0.0001" value="{{ reading.hco3 }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="fio2" class="block text-sm font-medium text-gray-700">FiO2 (%)</label>
                            <input type="number" name="fio2" id="fio2" step="0.0001" value="{{ reading.fio2 }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="ph" class="block text-sm font-medium text-gray-700">pH</label>
                            <input type="number" name="ph" id="ph" step="0.0001" value="{{ reading.ph }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="paco2" class="block text-sm font-medium text-gray-700">PaCO2 (mmHg)</label>
                            <input type="number" name="paco2" id="paco2" step="0.0001" value="{{ reading.paco2 }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="sao2" class="block text-sm font-medium text-gray-700">SaO2 (%)</label>
                            <input type="number" name="sao2" id="sao2" step="0.0001" value="{{ reading.sao2 }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                    </div>
                </div>

                <!-- Lab Values Section -->
                <div>
                    <h3 class="text-lg font-semibold mb-4" style="color: #3D0066;">Laboratory Values</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div>
                            <label for="bun" class="block text-sm font-medium text-gray-700">BUN (mg/dL)</label>
                            <input type="number" name="bun" id="bun" step="0.0001" value="{{ reading.bun }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="calcium" class="block text-sm font-medium text-gray-700">Calcium (mg/dL)</label>
                            <input type="number" name="calcium" id="calcium" step="0.0001" value="{{ reading.calcium }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="chloride" class="block text-sm font-medium text-gray-700">Chloride (mEq/L)</label>
                            <input type="number" name="chloride" id="chloride" step="0.0001" value="{{ reading.chloride }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="creatinine" class="block text-sm font-medium text-gray-700">Creatinine (mg/dL)</label>
                            <input type="number" name="creatinine" id="creatinine" step="0.0001" value="{{ reading.creatinine }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="bilirubin_direct" class="block text-sm font-medium text-gray-700">Direct Bilirubin (mg/dL)</label>
                            <input type="number" name="bilirubin_direct" id="bilirubin_direct" step="0.0001" value="{{ reading.bilirubin_direct }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="glucose" class="block text-sm font-medium text-gray-700">Glucose (mg/dL)</label>
                            <input type="number" name="glucose" id="glucose" step="0.0001" value="{{ reading.glucose }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="lactate" class="block text-sm font-medium text-gray-700">Lactate (mmol/L)</label>
                            <input type="number" name="lactate" id="lactate" step="0.0001" value="{{ reading.lactate }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="magnesium" class="block text-sm font-medium text-gray-700">Magnesium (mg/dL)</label>
                            <input type="number" name="magnesium" id="magnesium" step="0.0001" value="{{ reading.magnesium }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="phosphate" class="block text-sm font-medium text-gray-700">Phosphate (mg/dL)</label>
                            <input type="number" name="phosphate" id="phosphate" step="0.0001" value="{{ reading.phosphate }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="potassium" class="block text-sm font-medium text-gray-700">Potassium (mEq/L)</label>
                            <input type="number" name="potassium" id="potassium" step="0.0001" value="{{ reading.potassium }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="troponini" class="block text-sm font-medium text-gray-700">Troponin I (ng/mL)</label>
                            <input type="number" name="troponini" id="troponini" step="0.0001" value="{{ reading.troponini }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="hct" class="block text-sm font-medium text-gray-700">Hematocrit (%)</label>
                            <input type="number" name="hct" id="hct" step="0.0001" value="{{ reading.hct }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="hgb" class="block text-sm font-medium text-gray-700">Hemoglobin (g/dL)</label>
                            <input type="number" name="hgb" id="hgb" step="0.0001" value="{{ reading.hgb }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="ptt" class="block text-sm font-medium text-gray-700">PTT (seconds)</label>
                            <input type="number" name="ptt" id="ptt" step="0.0001" value="{{ reading.ptt }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="wbc" class="block text-sm font-medium text-gray-700">WBC (x10³/μL)</label>
                            <input type="number" name="wbc" id="wbc" step="0.0001" value="{{ reading.wbc }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="fibrinogen" class="block text-sm font-medium text-gray-700">Fibrinogen (mg/dL)</label>
                            <input type="number" name="fibrinogen" id="fibrinogen" step="0.0001" value="{{ reading.fibrinogen }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="platelets" class="block text-sm font-medium text-gray-700">Platelets (x10³/μL)</label>
                            <input type="number" name="platelets" id="platelets" step="0.0001" value="{{ reading.platelets }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                    </div>
                </div>

                <!-- Patient Demographics Section -->
                <div>
                    <h3 class="text-lg font-semibold mb-4" style="color: #3D0066;">Patient Demographics</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="age" class="block text-sm font-medium text-gray-700">Age (years)</label>
                            <input type="number" name="age" id="age" value="{{ patient.age }}" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="gender" class="block text-sm font-medium text-gray-700">Gender</label>
                            <select name="gender" id="gender" required class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                                <option value="0" {% if patient.gender == 'Female' %}selected{% endif %}>Female (0)</option>
                                <option value="1" {% if patient.gender == 'Male' %}selected{% endif %}>Male (1)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex items-center justify-end space-x-3">
                    <a href="{{ url_for('patient_detail', patient_id=patient.id) }}" class="bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50">Cancel</a>
                    <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white" style="background-color: #8B5CF6;">
                        Save Changes
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
